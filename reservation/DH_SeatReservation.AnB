Protocol : SeatReservation

Types : Agent A,B;
	Number X,Y,g,Request_Seat,Confirm_Data;
	Function pk;

Knowledge :
	A: A,B,pk(B),inv(A),g;
	B: A,B,pk(B),inv(pk(B)),g
	where A!=B

Actions :
A -> B: {A,B, exp(g,X) }inv(A)
B -> A: {A,B, exp(g,Y)} inv(pk(B))
A -> B: {|A,B, Request_Seat |} exp(exp(g,X),Y)
B -> A: {|B,A, Confirm_Data |} exp(exp(g,X),Y)

Goals :
A authenticates B on exp(exp(g,X),Y),Confirm_Data
B authenticates A on exp(exp(g,X),Y),Request_Seat
exp(exp(g,X),Y) secret between A,B
